{
  "vulnerabilities": [
    {
      "id": "SNYK-JAVA-ORGAPACHECOMMONS-2944970",
      "title": "Arbitrary Code Execution",
      "CVSSv3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C",
      "credit": [
        "Unknown"
      ],
      "semver": {
        "vulnerable": [
          "[2.4,2.8)"
        ]
      },
      "exploit": "Functional",
      "fixedIn": [
        "2.8"
      ],
      "patches": [],
      "insights": {
        "triageAdvice": null
      },
      "language": "java",
      "severity": "high",
      "cvssScore": 7.5,
      "functions": [],
      "malicious": false,
      "isDisputed": false,
      "moduleName": "org.apache.commons:commons-configuration2",
      "references": [
        {
          "url": "https://issues.apache.org/jira/browse/CONFIGURATION-764",
          "title": "Apache Jira Issue"
        },
        {
          "url": "https://lists.apache.org/thread/tdf5n7j80lfxdhs2764vn0xmpfodm87s",
          "title": "Apache Security Thread"
        },
        {
          "url": "https://github.com/apache/commons-configuration/commit/f025bc399e8125ffc7701ac74f09b833c5b5e152",
          "title": "GitHub Commit"
        }
      ],
      "cvssDetails": [
        {
          "assigner": "Red Hat",
          "severity": "high",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "cvssV3BaseScore": 7.5,
          "modificationTime": "2023-03-26T14:49:17.949398Z"
        },
        {
          "assigner": "NVD",
          "severity": "critical",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cvssV3BaseScore": 9.8,
          "modificationTime": "2022-11-16T13:11:41.428774Z"
        }
      ],
      "description": "## Overview\n[org.apache.commons:commons-configuration2](https://mvnrepository.com/artifact/org.apache.commons/commons-configuration2/2.0) is a group of tools to assist in the reading of configuration/preferences files in various formats.\n\nAffected versions of this package are vulnerable to Arbitrary Code Execution via the `Lookup` functionality due to the ability to use certain insecure lookups that perform interpolation.\r\n\r\nThese lookups are:\r\n\r\n1) `script` execute expressions using the JVM script execution engine (`javax.script`).\r\n\r\n2) `dns` resolve DNS records.\r\n\r\n3) `url` load values from URLs, including from remote servers.\r\n\r\n**CVSS Score Explanation:**\r\n\r\nThis module is designed for secure configuration management. This implies that the files it handles should have limited access, whether local or remote. Remote attacks require basic privileges and server setup for remote commands. This aligns with AC:H and PR:L\n## Remediation\nUpgrade `org.apache.commons:commons-configuration2` to version 2.8 or higher.\n## References\n- [Apache Jira Issue](https://issues.apache.org/jira/browse/CONFIGURATION-764)\n- [Apache Security Thread](https://lists.apache.org/thread/tdf5n7j80lfxdhs2764vn0xmpfodm87s)\n- [GitHub Commit](https://github.com/apache/commons-configuration/commit/f025bc399e8125ffc7701ac74f09b833c5b5e152)\n",
      "epssDetails": {
        "percentile": "0.97558",
        "probability": "0.67885",
        "modelVersion": "v2023.03.01"
      },
      "identifiers": {
        "CVE": [
          "CVE-2022-33980"
        ],
        "CWE": [
          "CWE-94"
        ]
      },
      "packageName": "org.apache.commons:commons-configuration2",
      "proprietary": false,
      "creationTime": "2022-07-07T14:22:57.215643Z",
      "functions_new": [],
      "alternativeIds": [],
      "disclosureTime": "2022-07-07T14:01:43Z",
      "packageManager": "maven",
      "mavenModuleName": {
        "groupId": "org.apache.commons",
        "artifactId": "commons-configuration2"
      },
      "publicationTime": "2022-07-08T09:45:33Z",
      "modificationTime": "2023-09-29T13:31:01.096866Z",
      "socialTrendAlert": false,
      "severityWithCritical": "high",
      "from": [
        "io.github.jensdietrich.xshady:CVE-2020-1953@1.0.0",
        "org.apache.commons:commons-configuration2@2.6"
      ],
      "upgradePath": [
        false,
        "org.apache.commons:commons-configuration2@2.8.0"
      ],
      "isUpgradable": true,
      "isPatchable": false,
      "name": "org.apache.commons:commons-configuration2",
      "version": "2.6"
    },
    {
      "id": "SNYK-JAVA-ORGAPACHECOMMONS-560326",
      "title": "Remote Code Execution (RCE)",
      "CVSSv3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H",
      "credit": [
        "Unknown"
      ],
      "semver": {
        "vulnerable": [
          "[2.2, 2.7)"
        ]
      },
      "exploit": "Not Defined",
      "fixedIn": [
        "2.7"
      ],
      "patches": [],
      "insights": {
        "triageAdvice": null
      },
      "language": "java",
      "severity": "high",
      "cvssScore": 7.5,
      "functions": [],
      "malicious": false,
      "isDisputed": false,
      "moduleName": "org.apache.commons:commons-configuration2",
      "references": [
        {
          "url": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
          "title": "GitHub Commit"
        }
      ],
      "cvssDetails": [
        {
          "assigner": "NVD",
          "severity": "critical",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "cvssV3BaseScore": 10,
          "modificationTime": "2022-01-03T18:06:34.877297Z"
        },
        {
          "assigner": "Red Hat",
          "severity": "critical",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "cvssV3BaseScore": 9,
          "modificationTime": "2022-09-01T21:58:34.168840Z"
        }
      ],
      "description": "## Overview\n[org.apache.commons:commons-configuration2](https://mvnrepository.com/artifact/org.apache.commons/commons-configuration2/2.0) is a group of tools to assist in the reading of configuration/preferences files in various formats.\n\nAffected versions of this package are vulnerable to Remote Code Execution (RCE). It uses a third-party library to parse YAML files (`org.yaml:snakeyaml`) which by default allows the instantiation of classes if the YAML includes special statements. Apache Commons Configuration did not change the default settings of this library. Therefore if a YAML file was loaded from an untrusted source, it could therefore load and execute code out of the control of the host application.\n## Remediation\nUpgrade `org.apache.commons:commons-configuration2` to version 2.7 or higher.\n## References\n- [GitHub Commit](https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641)\n",
      "epssDetails": {
        "percentile": "0.85559",
        "probability": "0.01598",
        "modelVersion": "v2023.03.01"
      },
      "identifiers": {
        "CVE": [
          "CVE-2020-1953"
        ],
        "CWE": [
          "CWE-94"
        ]
      },
      "packageName": "org.apache.commons:commons-configuration2",
      "proprietary": false,
      "creationTime": "2020-03-15T12:43:32.698718Z",
      "functions_new": [],
      "alternativeIds": [],
      "disclosureTime": "2020-03-13T16:31:48Z",
      "packageManager": "maven",
      "mavenModuleName": {
        "groupId": "org.apache.commons",
        "artifactId": "commons-configuration2"
      },
      "publicationTime": "2020-03-15T15:43:45.538586Z",
      "modificationTime": "2022-09-01T21:58:34.168840Z",
      "socialTrendAlert": false,
      "severityWithCritical": "high",
      "from": [
        "io.github.jensdietrich.xshady:CVE-2020-1953@1.0.0",
        "org.apache.commons:commons-configuration2@2.6"
      ],
      "upgradePath": [
        false,
        "org.apache.commons:commons-configuration2@2.7"
      ],
      "isUpgradable": true,
      "isPatchable": false,
      "name": "org.apache.commons:commons-configuration2",
      "version": "2.6"
    },
    {
      "id": "SNYK-JAVA-ORGAPACHECOMMONS-3043138",
      "title": "Arbitrary Code Execution",
      "CVSSv3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P",
      "credit": [
        "Alvaro Mu√±oz"
      ],
      "semver": {
        "vulnerable": [
          "[1.5,1.10.0)"
        ]
      },
      "exploit": "Proof of Concept",
      "fixedIn": [
        "1.10.0"
      ],
      "patches": [],
      "insights": {
        "triageAdvice": "This vulnerability is only applicable when variable string interpolation is being performed on untrusted input to the StringSubstitutor class."
      },
      "language": "java",
      "severity": "high",
      "cvssScore": 8.1,
      "functions": [],
      "malicious": false,
      "isDisputed": false,
      "moduleName": "org.apache.commons:commons-text",
      "references": [
        {
          "url": "https://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om",
          "title": "Apache Lists"
        },
        {
          "url": "https://github.com/apache/commons-text/commit/b9b40b903e2d1f9935039803c9852439576780ea",
          "title": "GitHub Commit"
        },
        {
          "url": "https://github.com/apache/commons-text/pull/341",
          "title": "GitHub PR"
        },
        {
          "url": "https://github.com/apache/commons-text/releases/tag/rel%2Fcommons-text-1.10.0",
          "title": "GitHub Release"
        },
        {
          "url": "https://snyk.io/blog/reviewing-cve-2022-42889-in-apache-commons-text/",
          "title": "Snyk Blog"
        }
      ],
      "cvssDetails": [
        {
          "assigner": "Red Hat",
          "severity": "critical",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cvssV3BaseScore": 9.8,
          "modificationTime": "2023-03-26T14:48:57.145950Z"
        },
        {
          "assigner": "NVD",
          "severity": "critical",
          "cvssV3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "cvssV3BaseScore": 9.8,
          "modificationTime": "2022-10-22T13:11:20.294183Z"
        }
      ],
      "description": "## Overview\n\nAffected versions of this package are vulnerable to Arbitrary Code Execution via the `StringSubstitutor` interpolator object. Exploiting this vulnerability is possible when untrusted data flows into the `StringSubstitutor.replace()` or `StringSubstitutor.replaceIn()` methods. \r\n\r\nDue to the nature of these methods as ones that process application data and not user input, a remote attacker would need prior access to a system in the affected environment positioned to supply such data.\r\n\r\n**Notes**\r\n\r\nThe Nashorn scripting engine that can be used to exploit this vulnerability was available by default in JDKs up to 14.0.2. As of JDK 15, this vulnerability can only be exploited if another scripting engine has been added, such as JEXL.\r\n\r\nVulnerable lookups:\r\n\r\n1) `script` - executes expressions using the JVM script execution engine (javax.script)\r\n\r\n2) `dns` - resolves dns records\r\n\r\n3) `url` - loads values from urls, including from remote servers\r\n\r\n## PoC\r\n\r\n```java\r\nfinal StringSubstitutor interpolator = StringSubstitutor.createInterpolator();\r\nString out = interpolator.replace(\"${script:javascript:java.lang.Runtime.getRuntime().exec('touch /tmp/foo')}\");\r\nSystem.out.println(out);\r\n```\n## Remediation\nUpgrade `org.apache.commons:commons-text` to version 1.10.0 or higher.\n## References\n- [Apache Lists](https://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om)\n- [GitHub Commit](https://github.com/apache/commons-text/commit/b9b40b903e2d1f9935039803c9852439576780ea)\n- [GitHub PR](https://github.com/apache/commons-text/pull/341)\n- [GitHub Release](https://github.com/apache/commons-text/releases/tag/rel%2Fcommons-text-1.10.0)\n- [Snyk Blog](https://snyk.io/blog/reviewing-cve-2022-42889-in-apache-commons-text/)\n",
      "epssDetails": {
        "percentile": "0.97931",
        "probability": "0.80862",
        "modelVersion": "v2023.03.01"
      },
      "identifiers": {
        "CVE": [
          "CVE-2022-42889"
        ],
        "CWE": [
          "CWE-94"
        ]
      },
      "packageName": "org.apache.commons:commons-text",
      "proprietary": false,
      "creationTime": "2022-10-13T14:44:26.521875Z",
      "functions_new": [],
      "alternativeIds": [],
      "disclosureTime": "2022-10-13T14:22:37Z",
      "packageManager": "maven",
      "mavenModuleName": {
        "groupId": "org.apache.commons",
        "artifactId": "commons-text"
      },
      "publicationTime": "2022-10-13T15:14:29Z",
      "modificationTime": "2023-09-23T15:25:12.108748Z",
      "socialTrendAlert": false,
      "severityWithCritical": "high",
      "from": [
        "io.github.jensdietrich.xshady:CVE-2020-1953@1.0.0",
        "org.apache.commons:commons-configuration2@2.6",
        "org.apache.commons:commons-text@1.8"
      ],
      "upgradePath": [
        false,
        "org.apache.commons:commons-configuration2@2.9.0",
        "org.apache.commons:commons-text@1.10.0"
      ],
      "isUpgradable": true,
      "isPatchable": false,
      "name": "org.apache.commons:commons-text",
      "version": "1.8"
    }
  ],
  "ok": false,
  "dependencyCount": 4,
  "org": "wtwhite",
  "policy": "# Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities.\nversion: v1.25.1\nignore: {}\npatch: {}\n",
  "isPrivate": true,
  "licensesPolicy": {
    "severities": {},
    "orgLicenseRules": {
      "AGPL-1.0": {
        "licenseType": "AGPL-1.0",
        "severity": "high",
        "instructions": ""
      },
      "AGPL-3.0": {
        "licenseType": "AGPL-3.0",
        "severity": "high",
        "instructions": ""
      },
      "Artistic-1.0": {
        "licenseType": "Artistic-1.0",
        "severity": "medium",
        "instructions": ""
      },
      "Artistic-2.0": {
        "licenseType": "Artistic-2.0",
        "severity": "medium",
        "instructions": ""
      },
      "CDDL-1.0": {
        "licenseType": "CDDL-1.0",
        "severity": "medium",
        "instructions": ""
      },
      "CPOL-1.02": {
        "licenseType": "CPOL-1.02",
        "severity": "high",
        "instructions": ""
      },
      "EPL-1.0": {
        "licenseType": "EPL-1.0",
        "severity": "medium",
        "instructions": ""
      },
      "GPL-2.0": {
        "licenseType": "GPL-2.0",
        "severity": "high",
        "instructions": ""
      },
      "GPL-3.0": {
        "licenseType": "GPL-3.0",
        "severity": "high",
        "instructions": ""
      },
      "LGPL-2.0": {
        "licenseType": "LGPL-2.0",
        "severity": "medium",
        "instructions": ""
      },
      "LGPL-2.1": {
        "licenseType": "LGPL-2.1",
        "severity": "medium",
        "instructions": ""
      },
      "LGPL-3.0": {
        "licenseType": "LGPL-3.0",
        "severity": "medium",
        "instructions": ""
      },
      "MPL-1.1": {
        "licenseType": "MPL-1.1",
        "severity": "medium",
        "instructions": ""
      },
      "MPL-2.0": {
        "licenseType": "MPL-2.0",
        "severity": "medium",
        "instructions": ""
      },
      "MS-RL": {
        "licenseType": "MS-RL",
        "severity": "medium",
        "instructions": ""
      },
      "SimPL-2.0": {
        "licenseType": "SimPL-2.0",
        "severity": "high",
        "instructions": ""
      }
    }
  },
  "packageManager": "maven",
  "ignoreSettings": {
    "adminOnly": false,
    "reasonRequired": false,
    "disregardFilesystemIgnores": false
  },
  "summary": "3 vulnerable dependency paths",
  "remediation": {
    "unresolved": [],
    "upgrade": {
      "org.apache.commons:commons-configuration2@2.6": {
        "upgradeTo": "org.apache.commons:commons-configuration2@2.9.0",
        "upgrades": [
          "org.apache.commons:commons-text@1.8",
          "org.apache.commons:commons-configuration2@2.6",
          "org.apache.commons:commons-configuration2@2.6"
        ],
        "vulns": [
          "SNYK-JAVA-ORGAPACHECOMMONS-3043138",
          "SNYK-JAVA-ORGAPACHECOMMONS-2944970",
          "SNYK-JAVA-ORGAPACHECOMMONS-560326"
        ]
      }
    },
    "patch": {},
    "ignore": {},
    "pin": {}
  },
  "filesystemPolicy": false,
  "filtered": {
    "ignore": [],
    "patch": []
  },
  "uniqueCount": 3,
  "projectName": "io.github.jensdietrich.xshady:CVE-2020-1953",
  "displayTargetFile": "pom.xml",
  "hasUnknownVersions": false,
  "path": "/home/wtwhite/code/xshady/CVE-2020-1953"
}
