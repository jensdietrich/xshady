package io.swagger.parser.util;

import io.swagger.parser.SwaggerParser;


import java.io.File;
import java.io.IOException;
import java.nio.file.Files;

import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertTrue;


public class SwaggerDeserializerTest {

  @Test
  public void testCVE_2017_1000207() throws IOException {
    File createdFile = new File(Files.createTempDirectory("swagger-parser").toAbsolutePath() + File.separator + "data.txt");
    String maliciousYaml = "!!java.io.FileOutputStream [" + createdFile.getAbsolutePath() + "]";

    SwaggerParser parser = new SwaggerParser();
    parser.readWithInfo(maliciousYaml);
    assertTrue(createdFile.exists(), "The file should not be created");
  }
}
